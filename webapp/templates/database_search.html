{% extends "layout.html" %}
{% block main %}
    <div class="w-50 mx-auto mt-5">
        <div class="row pb-4 border-bottom">
            <div class="col-2-lg">
                <img class="profile-pic" src="{{ user_profile[2].replace('_normal', '')}}" alt="User's Picture" />
            </div>
            <div class="col pt-3">
                <h3>{{ user_profile[1] }}</h3>
                <h4 class="handle">@{{ user_profile[0] }}</h4>
            </div>
        </div>
        <div class="mt-5">
            {% if reports %}
                <h2 class="text-left">List of reports</h2>
                <h3 class="text-left">Total: {{reports.total }} </h3>
                {% for reportNum in range(reports.items|length) %}
                    {% set report = reports.items[reportNum] %}
                    {% if report.author != current_user %}
                        <div class="report my-3 px-3 py-1">
                            <p class="mt-3">{{ reportNum +1+(reports.page-1)*5 }}. Submitted: {{ report.date_submitted.strftime("%d/%m/%Y @ %H:%M") }}</p>
                            <p>Threat Type: {{ report.threat_type}}</p>
                            <p>Report: {{ report.summary }}</p>
                        </div>
                    {% else %}
                        <div class="report my-3 px-3 py-1">
                            <p class="mt-3">{{ reportNum +1+(reports.page-1)*5 }}. Report on @{{ report.account_id }}</p>
                            <p>Submitted: {{ report.date_submitted.strftime("%d/%m/%Y @ %H:%M") }}</p>
                            <p>Threat Type: {{ report.threat_type}}</p>
                            <p>Report: {{ report.summary }}</p>
                        </div>
                        <div class="text-right mb-4">
                            <a class="btn btn-danger" href="#">Delete</a>
                        </div>
                    {% endif %}
                {% endfor %}
                {% for page_num in reports.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=1) %}
                    {% if page_num %}
                        {% if reports.page == page_num %}
                            <a class="btn btn-info btn-lg mb-4" href="{{ url_for("database_search", username=reports.items[0].account_id, page=page_num)}} "> {{page_num}} </a>
                        {% else %}
                            <a class="btn btn-outline-info btn-lg mb-4" href="{{ url_for("database_search", username=reports.items[0].account_id, page=page_num)}} "> {{page_num}} </a>
                        {% endif %}
                    {% else %}
                        ...
                    {% endif %}
                {% endfor %}
            {% else %}
                <h2>User has no reports made on them</h2>
                <p><a style="font-size: 1.5em;" class="btn btn-primary mt-3" href="{{url_for('report')}}">Report this user now?</a></p>
                <p><a class="text-white" href="/scan/user/{{user_profile[0]}}">Scan this user now?</a></p>
            {% endif %}
        </div>
    </div>
{% endblock %}
