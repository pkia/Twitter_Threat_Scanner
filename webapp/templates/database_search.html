{% extends "layout.html" %}
{% block main %}
    <h1 class="border-bottom w-50 mx-auto"> All Results for <span>@{{ user_profile[0] }}</span></h1>
    <h2>Name: {{ user_profile[1] }}</h2>
    <h2 class="mb-4"><img src={{ user_profile[2] }} alt="User's Picture"</h2>
    <section>
        <h2 class="border-bottom w-50 mx-auto"><b>Scan Results</b></h2>
        {% if scan_results %}
            <p>Threat Detected: {{scan_results.threat_detected}}</p>
            <p>Date Scanned: {{scan_results.date_scanned}}</p>
            <p>Danger Level: {{scan_results.threat_level}}</p>
        {% else %}
            <p>User has no scan results! <a href="{{url_for('scan')}}">Scan a user now?</a></p>
        {% endif %}
    </section>
    
    <section>
        <h2 class="border-bottom w-50 mx-auto"><b>User-made Reports</b></h2> 
        {% if reports %}
            <h3>Total: {{reports.total }} </h3>
            {% for report in reports.items %}
                <p>Report on {{ report.account_id }}</p>
                <p>Time: {{ report.date_submitted.strftime("%d-%m-%Y at %H:%M:%S") }} </p>
                <p>Threat Type: {{ report.threat_type}}</p>
                <p>{{ report.summary }}</p>
            {% endfor %}
    </section>
    
        {% for page_num in reports.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=1) %}
            {% if page_num %}
                {% if reports.page == page_num %}
                    <a class="btn btn-info mb-4" href="{{ url_for("database_search", username=reports.items[0].account_id, page=page_num)}} "> {{page_num}} </a>
                {% else %}
                    <a class="btn btn-outline-info mb-4" href="{{ url_for("database_search", username=reports.items[0].account_id, page=page_num)}} "> {{page_num}} </a>
                {% endif %}
            {% else %}
                ...
            {% endif %}
        {% endfor %}
        
        {% else %}
            <p>User has no reports made on them <a href="{{url_for('report')}}">Report a user now?</a></p>
            </section>
        {% endif %}
{% endblock %}
